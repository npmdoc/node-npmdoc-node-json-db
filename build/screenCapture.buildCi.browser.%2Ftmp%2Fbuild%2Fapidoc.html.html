<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/Belphemur/node-json-db">node-json-db (v0.7.3)</a>
</h1>
<h4>Database using JSON file as storage for Node.JS</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-json-db">module node-json-db</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.node-json-db">
            function <span class="apidocSignatureSpan"></span>node-json-db
            <span class="apidocSignatureSpan">(filename, saveOnPush, humanReadable)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.ArrayInfo">
            function <span class="apidocSignatureSpan">node-json-db.</span>ArrayInfo
            <span class="apidocSignatureSpan">(property, index)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.DBParentData">
            function <span class="apidocSignatureSpan">node-json-db.</span>DBParentData
            <span class="apidocSignatureSpan">(parent, data, jsonDB, dataPath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.JsonDB">
            function <span class="apidocSignatureSpan">node-json-db.</span>JsonDB
            <span class="apidocSignatureSpan">(filename, saveOnPush, humanReadable)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-json-db.</span>ArrayInfo.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-json-db.</span>DBParentData.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-json-db.</span>Errors</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-json-db.</span>JsonDB.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">node-json-db.</span>utils</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-json-db.ArrayInfo">module node-json-db.ArrayInfo</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.ArrayInfo.ArrayInfo">
            function <span class="apidocSignatureSpan">node-json-db.</span>ArrayInfo
            <span class="apidocSignatureSpan">(property, index)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-json-db.ArrayInfo.prototype">module node-json-db.ArrayInfo.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.ArrayInfo.prototype.delete">
            function <span class="apidocSignatureSpan">node-json-db.ArrayInfo.prototype.</span>delete
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.ArrayInfo.prototype.getData">
            function <span class="apidocSignatureSpan">node-json-db.ArrayInfo.prototype.</span>getData
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.ArrayInfo.prototype.getIndex">
            function <span class="apidocSignatureSpan">node-json-db.ArrayInfo.prototype.</span>getIndex
            <span class="apidocSignatureSpan">(data, avoidProperty)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.ArrayInfo.prototype.isValid">
            function <span class="apidocSignatureSpan">node-json-db.ArrayInfo.prototype.</span>isValid
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.ArrayInfo.prototype.setData">
            function <span class="apidocSignatureSpan">node-json-db.ArrayInfo.prototype.</span>setData
            <span class="apidocSignatureSpan">(data, value)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-json-db.DBParentData">module node-json-db.DBParentData</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.DBParentData.DBParentData">
            function <span class="apidocSignatureSpan">node-json-db.</span>DBParentData
            <span class="apidocSignatureSpan">(parent, data, jsonDB, dataPath)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-json-db.DBParentData.prototype">module node-json-db.DBParentData.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.DBParentData.prototype._checkArray">
            function <span class="apidocSignatureSpan">node-json-db.DBParentData.prototype.</span>_checkArray
            <span class="apidocSignatureSpan">(deletion)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.DBParentData.prototype.delete">
            function <span class="apidocSignatureSpan">node-json-db.DBParentData.prototype.</span>delete
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.DBParentData.prototype.getData">
            function <span class="apidocSignatureSpan">node-json-db.DBParentData.prototype.</span>getData
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.DBParentData.prototype.setData">
            function <span class="apidocSignatureSpan">node-json-db.DBParentData.prototype.</span>setData
            <span class="apidocSignatureSpan">(toSet)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-json-db.Errors">module node-json-db.Errors</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.Errors.DataError">
            function <span class="apidocSignatureSpan">node-json-db.Errors.</span>DataError
            <span class="apidocSignatureSpan">(msg, id, nested)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.Errors.DatabaseError">
            function <span class="apidocSignatureSpan">node-json-db.Errors.</span>DatabaseError
            <span class="apidocSignatureSpan">(msg, id, nested)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-json-db.JsonDB">module node-json-db.JsonDB</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.JsonDB.JsonDB">
            function <span class="apidocSignatureSpan">node-json-db.</span>JsonDB
            <span class="apidocSignatureSpan">(filename, saveOnPush, humanReadable)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-json-db.JsonDB.prototype">module node-json-db.JsonDB.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.JsonDB.prototype._getData">
            function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>_getData
            <span class="apidocSignatureSpan">(dataPath, create)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.JsonDB.prototype._getParentData">
            function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>_getParentData
            <span class="apidocSignatureSpan">(dataPath, create)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.JsonDB.prototype._processDataPath">
            function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>_processDataPath
            <span class="apidocSignatureSpan">(dataPath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.JsonDB.prototype.delete">
            function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>delete
            <span class="apidocSignatureSpan">(dataPath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.JsonDB.prototype.getData">
            function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>getData
            <span class="apidocSignatureSpan">(dataPath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.JsonDB.prototype.load">
            function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>load
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.JsonDB.prototype.push">
            function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>push
            <span class="apidocSignatureSpan">(dataPath, data, override)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.JsonDB.prototype.reload">
            function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>reload
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.JsonDB.prototype.save">
            function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>save
            <span class="apidocSignatureSpan">(force)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.node-json-db.utils">module node-json-db.utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.utils.mergeObject">
            function <span class="apidocSignatureSpan">node-json-db.utils.</span>mergeObject
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.utils.processArray">
            function <span class="apidocSignatureSpan">node-json-db.utils.</span>processArray
            <span class="apidocSignatureSpan">(property)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.utils.removeTrailingSlash">
            function <span class="apidocSignatureSpan">node-json-db.utils.</span>removeTrailingSlash
            <span class="apidocSignatureSpan">(dataPath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.node-json-db.utils.strEndWith">
            function <span class="apidocSignatureSpan">node-json-db.utils.</span>strEndWith
            <span class="apidocSignatureSpan">(str, suffix)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-json-db" id="apidoc.module.node-json-db">module node-json-db</a></h1>


    <h2>
        <a href="#apidoc.element.node-json-db.node-json-db" id="apidoc.element.node-json-db.node-json-db">
        function <span class="apidocSignatureSpan"></span>node-json-db
        <span class="apidocSignatureSpan">(filename, saveOnPush, humanReadable)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">node-json-db = function (filename, saveOnPush, humanReadable) {

    this.filename = filename;

    if (!JsonUtils.strEndWith(filename, ".json")) {
        this.filename += ".json";
    }
    var self = this;
    this.loaded = false;
    this.data = {};
    if (!FS.existsSync(this.filename)) {
        var dirname = path.dirname(this.filename);
        mkdirp.sync(dirname);
        self.save(true);
        self.loaded = true;
    }
    this.saveOnPush = ( typeof( saveOnPush ) == "boolean" ) ? saveOnPush : true;
    if (humanReadable) {
        this.humanReadable = humanReadable;
    }
    else {
        this.humanReadable = false;
    }

    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.ArrayInfo" id="apidoc.element.node-json-db.ArrayInfo">
        function <span class="apidocSignatureSpan">node-json-db.</span>ArrayInfo
        <span class="apidocSignatureSpan">(property, index)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ArrayInfo(property, index) {
    this.property = property;
    this.index = index;
    this.append = index === "";
    if (isInt(this.index)) {
        this.index = parseInt(this.index);
    } else if (!this.append) {
        throw new DataError("Only numerical values accepted for array index", 200)
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.DBParentData" id="apidoc.element.node-json-db.DBParentData">
        function <span class="apidocSignatureSpan">node-json-db.</span>DBParentData
        <span class="apidocSignatureSpan">(parent, data, jsonDB, dataPath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function DBParentData(parent, data, jsonDB, dataPath) {
    this.parent = parent;
    this.data = data;
    this.db = jsonDB;
    this.dataPath = dataPath;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.JsonDB" id="apidoc.element.node-json-db.JsonDB">
        function <span class="apidocSignatureSpan">node-json-db.</span>JsonDB
        <span class="apidocSignatureSpan">(filename, saveOnPush, humanReadable)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">JsonDB = function (filename, saveOnPush, humanReadable) {

    this.filename = filename;

    if (!JsonUtils.strEndWith(filename, ".json")) {
        this.filename += ".json";
    }
    var self = this;
    this.loaded = false;
    this.data = {};
    if (!FS.existsSync(this.filename)) {
        var dirname = path.dirname(this.filename);
        mkdirp.sync(dirname);
        self.save(true);
        self.loaded = true;
    }
    this.saveOnPush = ( typeof( saveOnPush ) == "boolean" ) ? saveOnPush : true;
    if (humanReadable) {
        this.humanReadable = humanReadable;
    }
    else {
        this.humanReadable = false;
    }

    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>












</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-json-db.ArrayInfo" id="apidoc.module.node-json-db.ArrayInfo">module node-json-db.ArrayInfo</a></h1>


    <h2>
        <a href="#apidoc.element.node-json-db.ArrayInfo.ArrayInfo" id="apidoc.element.node-json-db.ArrayInfo.ArrayInfo">
        function <span class="apidocSignatureSpan">node-json-db.</span>ArrayInfo
        <span class="apidocSignatureSpan">(property, index)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ArrayInfo(property, index) {
    this.property = property;
    this.index = index;
    this.append = index === "";
    if (isInt(this.index)) {
        this.index = parseInt(this.index);
    } else if (!this.append) {
        throw new DataError("Only numerical values accepted for array index", 200)
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-json-db.ArrayInfo.prototype" id="apidoc.module.node-json-db.ArrayInfo.prototype">module node-json-db.ArrayInfo.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.node-json-db.ArrayInfo.prototype.delete" id="apidoc.element.node-json-db.ArrayInfo.prototype.delete">
        function <span class="apidocSignatureSpan">node-json-db.ArrayInfo.prototype.</span>delete
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">delete = function (data) {
    var index = this.getIndex(data);
    data[this.property].splice(index, 1);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
} catch(error) {
//The error will tell you where the DataPath stopped. In this case test1
//Since /test1/test does't exist.
    console.error(error);
}

//Deleting data
db.<span class="apidocCodeKeywordSpan">delete</span>("/test1");

//Save the data (useful if you disable the saveOnPush)
db.save();

//In case you have a exterior change to the databse file and want to reload it
//use this method
db.reload();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.ArrayInfo.prototype.getData" id="apidoc.element.node-json-db.ArrayInfo.prototype.getData">
        function <span class="apidocSignatureSpan">node-json-db.ArrayInfo.prototype.</span>getData
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getData = function (data) {
    if (this.append) {
        throw new DataError("Can't get data when appending", 100);
    }
    var index = this.getIndex(data);
    return data[this.property][index];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
//You can't merge primitive.
//If you do this:
db.push("/test2/my/test/",10,false);
//the data will be overriden

//Get the data from the root
var data = db.<span class="apidocCodeKeywordSpan">getData</span>("/");

//From a particular DataPath
var data = db.getData("/test1");

//If you try to get some data from a DataPath that doesn't exists
//You'll get an Error
try {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.ArrayInfo.prototype.getIndex" id="apidoc.element.node-json-db.ArrayInfo.prototype.getIndex">
        function <span class="apidocSignatureSpan">node-json-db.ArrayInfo.prototype.</span>getIndex
        <span class="apidocSignatureSpan">(data, avoidProperty)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getIndex = function (data, avoidProperty) {
    if (avoidProperty === undefined) {
        avoidProperty = false;
    }
    var index = this.index;
    if (index == -1) {
        var dataIterable = avoidProperty ? data : data[this.property];

        if (dataIterable.length === 0) {
            return 0;
        }
        return dataIterable.length - 1;
    }
    return index;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @returns {*}
 * @constructor
 */
ArrayInfo.prototype.getData = function (data) {
    if (this.append) {
        throw new DataError("Can't get data when appending", 100);
    }
    var index = this.<span class="apidocCodeKeywordSpan">getIndex</span>(data);
    return data[this.property][index];
};

/**
 * Set the data for the array
 * @param data
 * @param value
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.ArrayInfo.prototype.isValid" id="apidoc.element.node-json-db.ArrayInfo.prototype.isValid">
        function <span class="apidocSignatureSpan">node-json-db.ArrayInfo.prototype.</span>isValid
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isValid = function (data) {
    var index = this.getIndex(data);
    return data[this.property].hasOwnProperty(index);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
DBParentData.prototype._checkArray = function (deletion) {
    if(typeof deletion === undefined) {
        deletion = false;
    }
    var arrayInfo = JsonUtils.processArray(this.parent);
    if (arrayInfo) {
        if ((!arrayInfo.append || deletion) &amp;&amp; !arrayInfo.<span class="apidocCodeKeywordSpan">isValid</span>(this.data
)) {
            throw new DataError("DataPath: /" + this.dataPath + ". Can't find index " + arrayInfo.index
 + " in array " + arrayInfo.property, 10);
        }
    }
    return arrayInfo;
};

DBParentData.prototype.getData = function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.ArrayInfo.prototype.setData" id="apidoc.element.node-json-db.ArrayInfo.prototype.setData">
        function <span class="apidocSignatureSpan">node-json-db.ArrayInfo.prototype.</span>setData
        <span class="apidocSignatureSpan">(data, value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setData = function (data, value) {
    if (this.append) {
        data[this.property].push(value);
    } else {
        var index = this.getIndex(data);
        data[this.property][index] = value;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var arrayInfo = JsonUtils.processArray(this.parent);
    if (arrayInfo) {
        if (!this.data.hasOwnProperty(arrayInfo.property)) {
            this.data[arrayInfo.property] = [];
        } else if (!Array.isArray(this.data[arrayInfo.property])) {
            throw new DataError("DataPath: /" + this.dataPath + ". " + arrayInfo.property + " is not an
 array.", 11);
        }
        arrayInfo.<span class="apidocCodeKeywordSpan">setData</span>(this.data, toSet);
    } else {
        this.data[this.parent] = toSet;
    }
};

DBParentData.prototype.delete = function () {
    if (this.parent === undefined) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-json-db.DBParentData" id="apidoc.module.node-json-db.DBParentData">module node-json-db.DBParentData</a></h1>


    <h2>
        <a href="#apidoc.element.node-json-db.DBParentData.DBParentData" id="apidoc.element.node-json-db.DBParentData.DBParentData">
        function <span class="apidocSignatureSpan">node-json-db.</span>DBParentData
        <span class="apidocSignatureSpan">(parent, data, jsonDB, dataPath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function DBParentData(parent, data, jsonDB, dataPath) {
    this.parent = parent;
    this.data = data;
    this.db = jsonDB;
    this.dataPath = dataPath;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-json-db.DBParentData.prototype" id="apidoc.module.node-json-db.DBParentData.prototype">module node-json-db.DBParentData.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.node-json-db.DBParentData.prototype._checkArray" id="apidoc.element.node-json-db.DBParentData.prototype._checkArray">
        function <span class="apidocSignatureSpan">node-json-db.DBParentData.prototype.</span>_checkArray
        <span class="apidocSignatureSpan">(deletion)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_checkArray = function (deletion) {
    if(typeof deletion === undefined) {
        deletion = false;
    }
    var arrayInfo = JsonUtils.processArray(this.parent);
    if (arrayInfo) {
        if ((!arrayInfo.append || deletion) &amp;&amp; !arrayInfo.isValid(this.data)) {
            throw new DataError("DataPath: /" + this.dataPath + ". Can't find index " + arrayInfo.index + " in array " + arrayInfo
.property, 10);
        }
    }
    return arrayInfo;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return arrayInfo;
};

DBParentData.prototype.getData = function () {
    if (this.parent === undefined) {
        return this.data;
    }
    var arrayInfo = this.<span class="apidocCodeKeywordSpan">_checkArray</span>();
    if (arrayInfo) {
        return arrayInfo.getData(this.data);
    } else {
        return this.data[this.parent];
    }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.DBParentData.prototype.delete" id="apidoc.element.node-json-db.DBParentData.prototype.delete">
        function <span class="apidocSignatureSpan">node-json-db.DBParentData.prototype.</span>delete
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">delete = function () {
    if (this.parent === undefined) {
        this.db.data = {};
    }
    var arrayInfo = this._checkArray(true);
    if (arrayInfo) {
        arrayInfo.delete(this.data);
    } else {
        delete this.data[this.parent];
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
} catch(error) {
//The error will tell you where the DataPath stopped. In this case test1
//Since /test1/test does't exist.
    console.error(error);
}

//Deleting data
db.<span class="apidocCodeKeywordSpan">delete</span>("/test1");

//Save the data (useful if you disable the saveOnPush)
db.save();

//In case you have a exterior change to the databse file and want to reload it
//use this method
db.reload();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.DBParentData.prototype.getData" id="apidoc.element.node-json-db.DBParentData.prototype.getData">
        function <span class="apidocSignatureSpan">node-json-db.DBParentData.prototype.</span>getData
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getData = function () {
    if (this.parent === undefined) {
        return this.data;
    }
    var arrayInfo = this._checkArray();
    if (arrayInfo) {
        return arrayInfo.getData(this.data);
    } else {
        return this.data[this.parent];
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
//You can't merge primitive.
//If you do this:
db.push("/test2/my/test/",10,false);
//the data will be overriden

//Get the data from the root
var data = db.<span class="apidocCodeKeywordSpan">getData</span>("/");

//From a particular DataPath
var data = db.getData("/test1");

//If you try to get some data from a DataPath that doesn't exists
//You'll get an Error
try {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.DBParentData.prototype.setData" id="apidoc.element.node-json-db.DBParentData.prototype.setData">
        function <span class="apidocSignatureSpan">node-json-db.DBParentData.prototype.</span>setData
        <span class="apidocSignatureSpan">(toSet)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setData = function (toSet) {
    if (this.parent === undefined) {
        this.db.data = toSet;
        return;
    }
    var arrayInfo = JsonUtils.processArray(this.parent);
    if (arrayInfo) {
        if (!this.data.hasOwnProperty(arrayInfo.property)) {
            this.data[arrayInfo.property] = [];
        } else if (!Array.isArray(this.data[arrayInfo.property])) {
            throw new DataError("DataPath: /" + this.dataPath + ". " + arrayInfo.property + " is not an array.", 11);
        }
        arrayInfo.setData(this.data, toSet);
    } else {
        this.data[this.parent] = toSet;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var arrayInfo = JsonUtils.processArray(this.parent);
    if (arrayInfo) {
        if (!this.data.hasOwnProperty(arrayInfo.property)) {
            this.data[arrayInfo.property] = [];
        } else if (!Array.isArray(this.data[arrayInfo.property])) {
            throw new DataError("DataPath: /" + this.dataPath + ". " + arrayInfo.property + " is not an
 array.", 11);
        }
        arrayInfo.<span class="apidocCodeKeywordSpan">setData</span>(this.data, toSet);
    } else {
        this.data[this.parent] = toSet;
    }
};

DBParentData.prototype.delete = function () {
    if (this.parent === undefined) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-json-db.Errors" id="apidoc.module.node-json-db.Errors">module node-json-db.Errors</a></h1>


    <h2>
        <a href="#apidoc.element.node-json-db.Errors.DataError" id="apidoc.element.node-json-db.Errors.DataError">
        function <span class="apidocSignatureSpan">node-json-db.Errors.</span>DataError
        <span class="apidocSignatureSpan">(msg, id, nested)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function DataError(msg, id, nested) {
    var error = NestedError.call(this, msg, id, nested);
    error.name = 'DataError';
    return error;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.Errors.DatabaseError" id="apidoc.element.node-json-db.Errors.DatabaseError">
        function <span class="apidocSignatureSpan">node-json-db.Errors.</span>DatabaseError
        <span class="apidocSignatureSpan">(msg, id, nested)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function DatabaseError(msg, id, nested) {
    var error = NestedError.call(this, msg, id, nested);
    error.name = 'DatabaseError';
    return error;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-json-db.JsonDB" id="apidoc.module.node-json-db.JsonDB">module node-json-db.JsonDB</a></h1>


    <h2>
        <a href="#apidoc.element.node-json-db.JsonDB.JsonDB" id="apidoc.element.node-json-db.JsonDB.JsonDB">
        function <span class="apidocSignatureSpan">node-json-db.</span>JsonDB
        <span class="apidocSignatureSpan">(filename, saveOnPush, humanReadable)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">JsonDB = function (filename, saveOnPush, humanReadable) {

    this.filename = filename;

    if (!JsonUtils.strEndWith(filename, ".json")) {
        this.filename += ".json";
    }
    var self = this;
    this.loaded = false;
    this.data = {};
    if (!FS.existsSync(this.filename)) {
        var dirname = path.dirname(this.filename);
        mkdirp.sync(dirname);
        self.save(true);
        self.loaded = true;
    }
    this.saveOnPush = ( typeof( saveOnPush ) == "boolean" ) ? saveOnPush : true;
    if (humanReadable) {
        this.humanReadable = humanReadable;
    }
    else {
        this.humanReadable = false;
    }

    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-json-db.JsonDB.prototype" id="apidoc.module.node-json-db.JsonDB.prototype">module node-json-db.JsonDB.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.node-json-db.JsonDB.prototype._getData" id="apidoc.element.node-json-db.JsonDB.prototype._getData">
        function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>_getData
        <span class="apidocSignatureSpan">(dataPath, create)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getData = function (dataPath, create) {

    this.load();

    create = create || false;
    dataPath = JsonUtils.removeTrailingSlash(dataPath);

    function recursiveProcessDataPath(data, index) {

        var property = dataPath[index];


        /**
         * Find the wanted Data or create it.
         */
        function findData(isArray) {
            isArray = isArray || false;
            if (data.hasOwnProperty(property)) {
                data = data[property];
            } else if (create) {
                if (isArray) {
                    data[property] = [];
                } else {
                    data[property] = {};
                }
                data = data[property];
            } else {
                throw new DataError("Can't find dataPath: /" + dataPath.join("/") + ". Stopped at " + property, 5);
            }
        }

        var arrayInfo = JsonUtils.processArray(property);
        if (arrayInfo) {
            property = arrayInfo.property;
            findData(true);
            if (!Array.isArray(data)) {
                throw new DataError("DataPath: /" + dataPath.join("/") + ". " + property + " is not an array.", 11);
            }
            var arrayIndex = arrayInfo.getIndex(data, true);
            if (data.hasOwnProperty(arrayIndex)) {
                data = data[arrayIndex];
            } else if (create) {
                if (arrayInfo.append) {
                    data.push({});
                    data = data[data.length - 1];
                }
                else {
                    data[arrayIndex] = {};
                    data = data[arrayIndex];
                }
            } else {
                throw new DataError("DataPath: /" + dataPath.join("/") + ". Can't find index " + arrayInfo.index + " in array " +
property, 10);
            }
        } else {
            findData();
        }

        if (dataPath.length == ++index) {
            return data;
        }
        return recursiveProcessDataPath(data, index);
    }

    if (dataPath.length === 0) {
        return this.data;
    }

    return recursiveProcessDataPath(this.data, 0);

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.JsonDB.prototype._getParentData" id="apidoc.element.node-json-db.JsonDB.prototype._getParentData">
        function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>_getParentData
        <span class="apidocSignatureSpan">(dataPath, create)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getParentData = function (dataPath, create) {
    var path = this._processDataPath(dataPath);
    var last = path.pop();
    return new DBParentData(last, this._getData(path, create), this, dataPath);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.JsonDB.prototype._processDataPath" id="apidoc.element.node-json-db.JsonDB.prototype._processDataPath">
        function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>_processDataPath
        <span class="apidocSignatureSpan">(dataPath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_processDataPath = function (dataPath) {
    if (dataPath === undefined || !dataPath.trim()) {
        throw new DataError("The Data Path can't be empty", 6);
    }
    if (dataPath == "/") {
        return [];
    }
    var path = dataPath.split("/");
    path.shift();
    return path;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.JsonDB.prototype.delete" id="apidoc.element.node-json-db.JsonDB.prototype.delete">
        function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>delete
        <span class="apidocSignatureSpan">(dataPath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">delete = function (dataPath) {
    dataPath = JsonUtils.removeTrailingSlash(dataPath);
    var dbData = this._getParentData(dataPath, true);
    if (!dbData) {
        return;
    }
    dbData.delete();

    if (this.saveOnPush) {
        this.save();
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
} catch(error) {
//The error will tell you where the DataPath stopped. In this case test1
//Since /test1/test does't exist.
    console.error(error);
}

//Deleting data
db.<span class="apidocCodeKeywordSpan">delete</span>("/test1");

//Save the data (useful if you disable the saveOnPush)
db.save();

//In case you have a exterior change to the databse file and want to reload it
//use this method
db.reload();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.JsonDB.prototype.getData" id="apidoc.element.node-json-db.JsonDB.prototype.getData">
        function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>getData
        <span class="apidocSignatureSpan">(dataPath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getData = function (dataPath) {
    var path = this._processDataPath(dataPath);
    return this._getData(path);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
//You can't merge primitive.
//If you do this:
db.push("/test2/my/test/",10,false);
//the data will be overriden

//Get the data from the root
var data = db.<span class="apidocCodeKeywordSpan">getData</span>("/");

//From a particular DataPath
var data = db.getData("/test1");

//If you try to get some data from a DataPath that doesn't exists
//You'll get an Error
try {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.JsonDB.prototype.load" id="apidoc.element.node-json-db.JsonDB.prototype.load">
        function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>load
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">load = function () {
    if (this.loaded) {
        return;
    }
    try {
        var data = FS.readFileSync(this.filename, 'utf8');
        this.data = JSON.parse(data);
        this.loaded = true;
    } catch (err) {
        var error = new DatabaseError("Can't Load Database", 1, err);
        error.inner = err;
        throw error;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.JsonDB.prototype.push" id="apidoc.element.node-json-db.JsonDB.prototype.push">
        function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>push
        <span class="apidocSignatureSpan">(dataPath, data, override)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">push = function (dataPath, data, override) {
    override = override === undefined ? true : override;

    dataPath = JsonUtils.removeTrailingSlash(dataPath);
    var dbData = this._getParentData(dataPath, true);
    if (!dbData) {
        throw new Error("Data not found");
    }
    var toSet = data;
    if (!override) {
        if (Array.isArray(data)) {
            var storedData = dbData.getData();
            if (storedData === undefined) {
                storedData = [];
            } else if (!Array.isArray(storedData)) {
                throw new DataError("Can't merge another type of data with an Array", 3);
            }
            toSet = storedData.concat(data);
        } else if (data === Object(data)) {
            if (Array.isArray(dbData.getData())) {
                throw  new DataError("Can't merge an Array with an Object", 4);
            }
            toSet = JsonUtils.mergeObject(dbData.getData(), data);
        }
    }
    dbData.setData(toSet);

    if (this.saveOnPush) {
        this.save();
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
//If you put false, you'll have to call the save() method.
//The third argument is to ask JsonDB to save the database in an human readable format. (default false)
var db = new JsonDB("myDataBase", true, false);

//Pushing the data into the database
//With the wanted DataPath
//By default the push will override the old value
db.<span class="apidocCodeKeywordSpan">push</span>("/test1","super test");

//It also create automatically the hierarchy when pushing new data for a DataPath that doesn't exists
db.push("/test2/my/test",5);

//You can also push directly objects
db.push("/test3", {test:"test", json: {test:["test"]}});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.JsonDB.prototype.reload" id="apidoc.element.node-json-db.JsonDB.prototype.reload">
        function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>reload
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reload = function () {
    this.loaded = false;
    return this.load();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
db.delete("/test1");

//Save the data (useful if you disable the saveOnPush)
db.save();

//In case you have a exterior change to the databse file and want to reload it
//use this method
db.<span class="apidocCodeKeywordSpan">reload</span>();

```

### Array Support
You can also access the information stored into arrays and manipulate them.
```javascript
var JsonDB = require('node-json-db');
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.JsonDB.prototype.save" id="apidoc.element.node-json-db.JsonDB.prototype.save">
        function <span class="apidocSignatureSpan">node-json-db.JsonDB.prototype.</span>save
        <span class="apidocSignatureSpan">(force)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">save = function (force) {
    force = force || false;
    if (!force &amp;&amp; !this.loaded) {
        throw new DatabaseError("DataBase not loaded. Can't write", 7);
    }
    var data = "";
    try {
        if (this.humanReadable) {
            data = JSON.stringify(this.data, null, 4);
        }
        else {
            data = JSON.stringify(this.data);
        }
        FS.writeFileSync(this.filename, data, 'utf8');
    } catch (err) {
        var error = new DatabaseError("Can't save the database", 2, err);
        error.inner = err;
        throw error;
    }

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    console.error(error);
}

//Deleting data
db.delete("/test1");

//Save the data (useful if you disable the saveOnPush)
db.<span class="apidocCodeKeywordSpan">save</span>();

//In case you have a exterior change to the databse file and want to reload it
//use this method
db.reload();

```
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.node-json-db.utils" id="apidoc.module.node-json-db.utils">module node-json-db.utils</a></h1>


    <h2>
        <a href="#apidoc.element.node-json-db.utils.mergeObject" id="apidoc.element.node-json-db.utils.mergeObject">
        function <span class="apidocSignatureSpan">node-json-db.utils.</span>mergeObject
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mergeObject = function () {
    var destination = {},
        sources = [].slice.call(arguments, 0);
    sources.forEach(function (source) {
        var prop;
        for (prop in source) {

            if (prop in destination &amp;&amp; destination[prop] === null) {
                destination[prop] = source[prop];
            }
            else if (prop in destination &amp;&amp; Array.isArray(destination[prop])) {

                // Concat Arrays
                destination[prop] = destination[prop].concat(source[prop]);

            } else if (prop in destination &amp;&amp; typeof destination[prop] === "object") {

                // Merge Objects
                destination[prop] = merge(destination[prop], source[prop]);

            } else {

                // Set new values
                destination[prop] = source[prop];

            }
        }
    });
    return destination;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.utils.processArray" id="apidoc.element.node-json-db.utils.processArray">
        function <span class="apidocSignatureSpan">node-json-db.utils.</span>processArray
        <span class="apidocSignatureSpan">(property)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">processArray = function (property) {
    var match = arrayIndexRegex.exec(property);
    if (match != null) {
        return new ArrayInfo(match[1], match[2]);
    }
    return null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @returns {ArrayInfo}
 * @private
 */
DBParentData.prototype._checkArray = function (deletion) {
    if(typeof deletion === undefined) {
        deletion = false;
    }
    var arrayInfo = JsonUtils.<span class="apidocCodeKeywordSpan">processArray</span>(this.parent);
    if (arrayInfo) {
        if ((!arrayInfo.append || deletion) &amp;&amp; !arrayInfo.isValid(this.data)) {
            throw new DataError("DataPath: /" + this.dataPath + ". Can't find index " + arrayInfo.index
 + " in array " + arrayInfo.property, 10);
        }
    }
    return arrayInfo;
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.utils.removeTrailingSlash" id="apidoc.element.node-json-db.utils.removeTrailingSlash">
        function <span class="apidocSignatureSpan">node-json-db.utils.</span>removeTrailingSlash
        <span class="apidocSignatureSpan">(dataPath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function removeTrailingSlash(dataPath) {
    if(dataPath.length &gt; 1 &amp;&amp; endsWith(dataPath,"/")) {
        return dataPath.substring(0, dataPath.length - 1);
    }
    return dataPath;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.node-json-db.utils.strEndWith" id="apidoc.element.node-json-db.utils.strEndWith">
        function <span class="apidocSignatureSpan">node-json-db.utils.</span>strEndWith
        <span class="apidocSignatureSpan">(str, suffix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">strEndWith = function (str, suffix) {
    return str.indexOf(suffix, str.length - suffix.length) !== -1;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>